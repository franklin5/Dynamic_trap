function H=computeH(len,V,c,psi,h,x)
H=1/h^2*eye(len,len)+diag(V+c*abs(psi).^2)+...
    diag(-1/(2*h^2)*ones(length(x)-1,1),1)+...
    diag(-1/(2*h^2)*ones(length(x)-1,1),-1);
end